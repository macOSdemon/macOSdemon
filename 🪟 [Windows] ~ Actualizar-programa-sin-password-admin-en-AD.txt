# üß† Lo que voy hacer en este apartado es dar permisos a un solo programa en un solo equipo, en AD, para actualizar el programa sin pedir la contrase√±a de administrador.

===========================================================================================================================
[Caso-1]:
# üß† Doy permisos a la carpeta del programa, para todos los usuarios de ese √∫nico equipo
# üß† Como solo va a existir un equipo por usuario, no tengo problema con esto

1Ô∏è‚É£ Identifica d√≥nde est√° instalado SAGE
Normalmente:
-----------------------------------------------------
C:\Program Files\Sage\
C:\Program Files (x86)\Sage\
-----------------------------------------------------

2Ô∏è‚É£ Da permisos solo a esa carpeta
En el PC del usuario (o v√≠a GPO):
Clic derecho en la carpeta de SAGE
Propiedades ‚Üí Seguridad ‚Üí Editar
Modifico el siguienteu suario : <NOMBRE-DEL-EQUIPO>\Usuarios            # Este usuario pertenece al resto de usuarios pero como solo lo voy a modificar en un solo pc los cambios solo se realizar√°n en ese pc y no en el resto del AD
Concede:
    Modificar
    Escritura
    Lectura y ejecuci√≥n

‚ö†Ô∏è NO le des Control total, con Modificar suele ser suficiente.

3Ô∏è‚É£ Permisos en el registro (MUY IMPORTANTE para SAGE)
üß† Muchos SAGE fallan al actualizar por el registro. Cuando SAGE intenta actualizar, quiere cambiar la versi√≥n, a√±adir o modificar claves, marcar que el update fue correcto.
üß† Guarda versi√≥n, rutas, par√°metros del producto
Revisa estas posibles rutas (depende versi√≥n):
-----------------------------------------------------
# registro de usuarios
HKEY_CURRENT_USER\Software\Sage
# con 64 bits (HKEY_LOCAL_MACHINE)
HKEY_LOCAL_MACHINE\SOFTWARE\Sage
HKEY_LOCAL_MACHINE\SOFTWARE\Sage\Sage50
HKEY_LOCAL_MACHINE\SOFTWARE\Sage\Contabilidad
HKEY_LOCAL_MACHINE\SOFTWARE\Sage\Nomina
HKEY_LOCAL_MACHINE\SOFTWARE\Sage\Version
# con 32 bits en Windows 64 bits (HKEY_LOCAL_MACHINE)
HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Sage\Sage50
HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Sage\Contabilidad
HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Sage\Nomina
HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Sage\Version
-----------------------------------------------------
Pasos:
    regedit
    Clic derecho ‚Üí Permisos
    A√±ade el usuario o grupo
    Dale Control total o al menos Escritura

üëâ Esto no da permisos de admin, solo acceso a esas claves.


===========================================================================================================================
[Caso-2]:
# üß† Creo una tarea bajo el Usuario real del equipo "Usuario", para que actualice ese programa

# Task Scheduler para actualizar Sage

# Comprobar que existe el usuario
lusrmgr.msc ‚Üí Usuarios ‚Üí Usuario 

# Abrir Task Scheduler
taskschd.msc ‚Üí ‚ÄúCrear tarea‚Äù (no b√°sica)

# Configurar la tarea
#general:
Nombre: Actualizar Sage
Cambiar Usuario o grupo > Opciones avanzadas > Buscar ahora > Usuario > Aceptar
[x] Ejecutar con los privilegios m√°s altos
[x] Ejecutar tanto si el usuario inici√≥ sesi√≥n como si no
[ ] No almacenar contrase√±a
Configurar para: Windows 10
#acciones:
Nueva:
Acci√≥n: Iniciar un programa
Programa: C:\Program Files (x86)\Sage\Sage.exe
Argumentos: si aplica
#condiciones:
-Inactivo
[ ] Iniciar la tarea solo si el equipo est√° inactivo durante: 10 minutos
Esperar a que est√© inactivo durante: 1 hora
[ ] Detener si el equipo deja de estar inactivo
[ ] Reiniciar si el estado de inactividad se reanuda
- Energia
[ ] Iniciar la tarea solo si el equipo est√° conectado a la corriente alterna
[ ] Aceptar el equipo para ejecutar esta tarea

# creo acceso directo y lo dejo en el inicio para que al ejecutarlo inicie la tarea
click derecho > nuevo > acceso directo
-----------------------------------------------------------------------------------
schtasks /run /tn "Actualizar Sage"
-----------------------------------------------------------------------------------




===========================================================================================================================
[Caso-2]:
# üß† Windows otorga permisos de control total al usuario sobre su propia carpeta de AppData
# üß† Al no ser una ruta del sistema (como Program Files), el Control de Cuentas de Usuario (UAC) no interviene porque no hay riesgo de afectar a otros usuarios o al n√∫cleo del sistema.

# Cambiar la ruta de instalaci√≥n a la siguiente
C:\Users\USUARIO\AppData\Local

# por ejemplo
C:\Users\USUARIO\AppData\Local\Google\Chrome

# üß† Por qu√© NO pide contrase√±a ah√≠
‚úî Pertenece 100 % al usuario
‚úî El usuario tiene control total por defecto
‚úî Windows NO protege esa carpeta con UAC
